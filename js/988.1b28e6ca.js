"use strict";(self["webpackChunkdebug_bridge_client_tasty"]=self["webpackChunkdebug_bridge_client_tasty"]||[]).push([[988],{8988:function(e,t,a){a.r(t),a.d(t,{default:function(){return y}});a(8992),a(4520),a(2577),a(3949),a(1454);var l=a(6768),d=a(4232),o=a(144),i=a(1219),n=a(1387),u=a(158);function s(e){return(0,u.A)({url:`http://${e}/bridge/adb_devices`,method:"get",params:{}})}function c(e,t){return(0,u.A)({url:`http://${e}/bridge/device_ip?device_id=${t}`,method:"get",params:{}})}function r(e,t){return(0,u.A)({url:`http://${e}/bridge/device/wake_up?device_id=${t}`,method:"post",params:{}})}function p(e,t){return(0,u.A)({url:`http://${e}/bridge/device/reboot?device_id=${t}`,method:"post",params:{}})}const b={style:{"background-color":"yellow"}},f={class:"checkbox-container",style:{"margin-left":"10px"}},k={class:"resize-button"},g={key:0},m=["id"];var v=(0,l.pM)({__name:"DeviceViewer",setup(e){let t;const a=(0,o.KR)(50);let u=(0,o.KR)([]),v=(0,o.KR)(!1),_=(0,o.KR)(!1);const h=(0,n.lq)();let y=(0,l.EW)((()=>h.query.server)).value?.toString();y=y||"";const F=y.split(":")[0],w=(0,l.EW)((()=>h.query.name)).value;let C=(0,o.KR)([]);function x(e){const t=/[A-Z]/;return t.test(e)}(0,l.xo)((()=>{t&&clearInterval(t)})),(0,l.KC)((async()=>{await R()})),(0,l.sV)((()=>{t=setInterval(L,2500)}));const R=async()=>{if(void 0!=t&&(clearInterval(t),t=void 0),void 0==y||null==y||""==y||!y)return;_.value=!0;const e=await s(y),a=e.data?e.data:[];u.value=a.map((e=>({udid:e,device_ip:"",screenshot_url:"",fill_ratio:50,show:!e.includes(":")&&!x(e),refreshLoading:!1,wakeUpLoading:!1,rebootLoading:!1})));const l=u.value.filter((e=>e.show)).map((e=>e.udid));U(l),L(),_.value=!1},L=()=>{u.value.forEach((e=>{const t=document.getElementById(`screenshot-${e.udid}`);t&&(t.src=`http://${y}/bridge/adb_screenshot?device_id=${e.udid}&timestamp=${(new Date).getTime()}`)}))},V=(0,o.KR)(!1),$=(0,o.KR)(!0),W=e=>{u.value.forEach((t=>{t.show=e})),C.value=e?u.value.map((e=>e.udid)):[],$.value=!1},U=e=>{const t=e.length;V.value=t===u.value.length,$.value=t>0&&t<u.value.length,C.value=e,u.value.forEach((t=>{t.show=e.includes(t.udid)}))},E=e=>{navigator.clipboard.writeText(e).then((()=>{(0,i.nk)({message:"Congrats, Device UDID is copied to clipboard.",type:"success"})})).catch((()=>{i.nk.error("Oops, failed to copy device UDID to clipboard.")}))},I=async e=>{v.value=!0;const t=await c(y,e),a=t.data.device_ip;v.value=!1,navigator.clipboard.writeText(a).then((()=>{(0,i.nk)({message:"Congrats, Device IP is copied to clipboard.",type:"success"})})).catch((()=>{i.nk.error("Oops, failed to copy device IP to clipboardd.")})),window.open(`http://${a}`,"_blank")},X=()=>{u.value.forEach((e=>{e.fill_ratio=50})),a.value=50},D=e=>{const t=u.value.find((t=>t.udid===e));t&&(t.show=!1,C.value=C.value.filter((t=>t!==e)))},K=async e=>{const t=u.value.find((t=>t.udid===e));if(!t)return;t.refreshLoading=!0;const a=document.getElementById(`screenshot-${e}`);a&&(a.src="",a.src=`http://${y}/bridge/adb_screenshot?device_id=${e}&timestamp=${(new Date).getTime()}`,setTimeout((()=>{t.refreshLoading=!1}),2e3))},Q=async e=>{const t=u.value.find((t=>t.udid===e));if(!t)return;t.wakeUpLoading=!0;const a=await r(y,e);t.wakeUpLoading=!1,(0,i.nk)({message:a.data.message,showClose:!0,center:!0,type:"success"==a.data.status?"success":"error",duration:5e3})},A=async e=>{const t=u.value.find((t=>t.udid===e));if(!t)return;t.rebootLoading=!0;const a=await p(y,e);t.rebootLoading=!1,(0,i.nk)({message:a.data.message,showClose:!0,center:!0,type:"success"==a.data.status?"success":"error",duration:5e3})};return(e,t)=>{const i=(0,l.g2)("el-checkbox"),n=(0,l.g2)("el-checkbox-group"),s=(0,l.g2)("el-button"),c=(0,l.g2)("el-aside"),r=(0,l.g2)("el-empty"),p=(0,l.g2)("el-col"),h=(0,l.g2)("el-slider"),y=(0,l.g2)("el-row"),x=(0,l.g2)("CopyDocument"),L=(0,l.g2)("el-icon"),T=(0,l.g2)("el-tooltip"),q=(0,l.g2)("ChromeFilled"),P=(0,l.g2)("Refresh"),z=(0,l.g2)("RefreshRight"),B=(0,l.g2)("Sunrise"),O=(0,l.g2)("el-button-group"),S=(0,l.g2)("DeleteFilled"),H=(0,l.g2)("el-space"),M=(0,l.g2)("el-card"),Z=(0,l.g2)("el-main"),j=(0,l.g2)("el-container");return(0,l.uX)(),(0,l.CE)("div",null,[(0,l.bF)(j,{style:{display:"flex"}},{default:(0,l.k6)((()=>[(0,l.bF)(c,{style:{"background-color":"#001f3f",width:"200px",margin:"0",padding:"0"}},{default:(0,l.k6)((()=>[(0,l.Lk)("div",null,[(0,l.Lk)("span",b,(0,d.v_)((0,o.R1)(w))+": "+(0,d.v_)((0,o.R1)(F)),1),(0,l.Lk)("div",f,[(0,l.bF)(i,{class:"checkbox-left",modelValue:V.value,"onUpdate:modelValue":t[0]||(t[0]=e=>V.value=e),indeterminate:$.value,onChange:W},{default:(0,l.k6)((()=>t[3]||(t[3]=[(0,l.eW)("View all devices")]))),_:1},8,["modelValue","indeterminate"]),(0,l.bF)(n,{class:"checkbox-group-left",modelValue:(0,o.R1)(C),"onUpdate:modelValue":t[1]||(t[1]=e=>(0,o.i9)(C)?C.value=e:C=e),onChange:U},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)((0,o.R1)(u),(e=>((0,l.uX)(),(0,l.Wv)(i,{class:"checkbox-left",key:e.udid,label:e.udid},{default:(0,l.k6)((()=>[(0,l.eW)((0,d.v_)(e.udid),1)])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue"])]),(0,l.Lk)("div",k,[(0,l.bF)(s,{type:"primary",onClick:R,loading:(0,o.R1)(_)},{default:(0,l.k6)((()=>[(0,o.R1)(_)?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.CE)("span",g,"Reload"))])),_:1},8,["loading"]),(0,l.bF)(s,{type:"success",onClick:X},{default:(0,l.k6)((()=>t[4]||(t[4]=[(0,l.eW)("Resize")]))),_:1})])])])),_:1}),(0,l.bF)(Z,null,{default:(0,l.k6)((()=>[0==(0,o.R1)(C).length?((0,l.uX)(),(0,l.Wv)(r,{key:0,description:"Please wait..."})):(0,l.Q3)("",!0),(0,l.bF)(y,{gutter:"1"},{default:(0,l.k6)((()=>[(0,l.bF)(p,{span:23},{default:(0,l.k6)((()=>[(0,l.bF)(H,{wrap:""},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)((0,o.R1)(u),(e=>((0,l.uX)(),(0,l.CE)("div",{key:e.udid},[e.show?((0,l.uX)(),(0,l.Wv)(M,{key:0,class:"box-card",style:(0,d.Tr)({width:550+10*(e.fill_ratio-50)+10*(a.value-50)+"px"})},{default:(0,l.k6)((()=>[(0,l.bF)(y,{gutter:"1"},{default:(0,l.k6)((()=>[(0,l.bF)(p,{span:23},{default:(0,l.k6)((()=>[(0,l.Lk)("img",{style:{width:"98%",height:"auto"},id:"screenshot-"+e.udid,draggable:"false",src:""},null,8,m)])),_:2},1024),(0,l.bF)(p,{span:1},{default:(0,l.k6)((()=>[(0,l.bF)(h,{modelValue:e.fill_ratio,"onUpdate:modelValue":t=>e.fill_ratio=t,vertical:"",min:20,max:100,step:1},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024)])),_:2},1024),(0,l.bF)(H,null,{default:(0,l.k6)((()=>[(0,l.Lk)("span",null,(0,d.v_)(e.udid),1),(0,l.bF)(O,{class:"ml-4"},{default:(0,l.k6)((()=>[(0,l.bF)(T,{class:"box-item",effect:"dark",content:"Copy udid",placement:"bottom"},{default:(0,l.k6)((()=>[(0,l.bF)(s,{onClick:t=>E(e.udid),type:"primary"},{default:(0,l.k6)((()=>[(0,l.bF)(L,null,{default:(0,l.k6)((()=>[(0,l.bF)(x)])),_:1})])),_:2},1032,["onClick"])])),_:2},1024),(0,l.bF)(T,{class:"box-item",effect:"dark",content:"WebUI",placement:"bottom"},{default:(0,l.k6)((()=>[(0,l.bF)(s,{onClick:t=>I(e.udid),loading:(0,o.R1)(v),class:"fixed-small-button",type:"primary"},{default:(0,l.k6)((()=>[(0,o.R1)(v)?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(L,{key:0},{default:(0,l.k6)((()=>[(0,l.bF)(q)])),_:1}))])),_:2},1032,["onClick","loading"])])),_:2},1024),(0,l.bF)(T,{class:"box-item",effect:"dark",content:"Refresh",placement:"bottom"},{default:(0,l.k6)((()=>[(0,l.bF)(s,{type:"primary",onClick:t=>K(e.udid),loading:e.refreshLoading,class:"fixed-small-button"},{default:(0,l.k6)((()=>[e.refreshLoading?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(L,{key:0},{default:(0,l.k6)((()=>[(0,l.bF)(P)])),_:1}))])),_:2},1032,["onClick","loading"])])),_:2},1024),(0,l.bF)(T,{class:"box-item",effect:"dark",content:"Wake Up",placement:"bottom"},{default:(0,l.k6)((()=>[(0,l.bF)(s,{type:"primary",onClick:t=>Q(e.udid),loading:e.wakeUpLoading,class:"fixed-small-button"},{default:(0,l.k6)((()=>[e.wakeUpLoading?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(L,{key:0},{default:(0,l.k6)((()=>[(0,l.bF)(z)])),_:1}))])),_:2},1032,["onClick","loading"])])),_:2},1024),(0,l.bF)(T,{class:"box-item",effect:"dark",content:"Reboot",placement:"bottom"},{default:(0,l.k6)((()=>[(0,l.bF)(s,{type:"primary",onClick:t=>A(e.udid),loading:e.rebootLoading,class:"fixed-small-button"},{default:(0,l.k6)((()=>[e.rebootLoading?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(L,{key:0},{default:(0,l.k6)((()=>[(0,l.bF)(B)])),_:1}))])),_:2},1032,["onClick","loading"])])),_:2},1024)])),_:2},1024),(0,l.bF)(T,{class:"box-item",effect:"dark",content:"Hide View",placement:"bottom"},{default:(0,l.k6)((()=>[(0,l.bF)(s,{type:"danger",onClick:t=>D(e.udid)},{default:(0,l.k6)((()=>[(0,l.bF)(L,null,{default:(0,l.k6)((()=>[(0,l.bF)(S)])),_:1})])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1032,["style"])):(0,l.Q3)("",!0)])))),128))])),_:1})])),_:1}),(0,l.bF)(p,{span:1},{default:(0,l.k6)((()=>[0!=(0,o.R1)(C).length?((0,l.uX)(),(0,l.Wv)(h,{key:0,modelValue:a.value,"onUpdate:modelValue":t[2]||(t[2]=e=>a.value=e),vertical:"",min:20,max:100,step:1},null,8,["modelValue"])):(0,l.Q3)("",!0)])),_:1})])),_:1})])),_:1})])),_:1})])}}}),_=a(1241);const h=(0,_.A)(v,[["__scopeId","data-v-946c0bec"]]);var y=h}}]);
//# sourceMappingURL=988.1b28e6ca.js.map